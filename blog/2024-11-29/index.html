
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Program in YAML — Code is Data">
      
      
        <meta name="author" content="Ingy döt Net">
      
      
        <link rel="canonical" href="https://yamlscript.org/blog/2024-11-29/">
      
      
        <link rel="prev" href="../../doc/run-ys/">
      
      
        <link rel="next" href="../2024-11-05/">
      
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>The Kubernetes Effect - YS — YAML without Limits</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96m0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32m32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16m16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M320 0c17.7 0 32 14.3 32 32v64h120c39.8 0 72 32.2 72 72v272c0 39.8-32.2 72-72 72H168c-39.8 0-72-32.2-72-72V168c0-39.8 32.2-72 72-72h120V32c0-17.7 14.3-32 32-32M208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zM264 256a40 40 0 1 0-80 0 40 40 0 1 0 80 0m152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80M48 224h16v192H48c-26.5 0-48-21.5-48-48v-96c0-26.5 21.5-48 48-48m544 0c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-16V224z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 398.9c58.5-41.1 96-104.1 96-174.9C512 100.3 397.4 0 256 0S0 100.3 0 224c0 70.7 37.5 133.8 96 174.9V464c0 26.5 21.5 48 48 48h48v-48c0-8.8 7.2-16 16-16s16 7.2 16 16v48h64v-48c0-8.8 7.2-16 16-16s16 7.2 16 16v48h48c26.5 0 48-21.5 48-48v-65.1M96 256a64 64 0 1 1 128 0 64 64 0 1 1-128 0m256-64a64 64 0 1 1 0 128 64 64 0 1 1 0-128"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M288 0H128c-17.7 0-32 14.3-32 32s14.3 32 32 32v132.8c0 11.8-3.3 23.5-9.5 33.5L10.3 406.2C3.6 417.2 0 429.7 0 442.6 0 480.9 31.1 512 69.4 512h309.2c38.3 0 69.4-31.1 69.4-69.4 0-12.8-3.6-25.4-10.3-36.4L329.5 230.4c-6.2-10.1-9.5-21.7-9.5-33.5V64c17.7 0 32-14.3 32-32S337.7 0 320 0zm-96 196.8V64h64v132.8c0 23.7 6.6 46.9 19 67.1l34.5 56.1h-171l34.5-56.1c12.4-20.2 19-43.4 19-67.1"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.1 52.4 442.6 6.5c-1.9-3.9-6.1-6.5-10.5-6.5s-8.5 2.6-10.4 6.5l-16.5 45.9-46 16.8c-4.3 1.6-7.3 5.9-7.2 10.4 0 4.5 3 8.7 7.2 10.2l45.7 16.8 16.8 45.8c1.5 4.4 5.8 7.5 10.4 7.5s8.9-3.1 10.4-7.5l16.5-45.8 45.7-16.8c4.2-1.5 7.2-5.7 7.2-10.2 0-4.6-3-8.9-7.2-10.4zm-132.4 53c-12.5-12.5-32.8-12.5-45.3 0l-2.9 2.9c-22-8-45.8-12.3-70.5-12.3C93.1 96 0 189.1 0 304s93.1 208 208 208 208-93.1 208-208c0-24.7-4.3-48.5-12.2-70.5l2.9-2.9c12.5-12.5 12.5-32.8 0-45.3l-80-80zM200 192c-57.4 0-104 46.6-104 104v8c0 8.8-7.2 16-16 16s-16-7.2-16-16v-8c0-75.1 60.9-136 136-136h8c8.8 0 16 7.2 16 16s-7.2 16-16 16z"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512m-40-176h24v-64h-24c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-80c-13.3 0-24-10.7-24-24s10.7-24 24-24m40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64"/></svg>');--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h224V368c0-26.5 21.5-48 48-48h112V96c0-35.3-28.7-64-64-64zm384 320H336c-8.8 0-16 7.2-16 16v112l32-32 64-64z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512m-86.2-346.7c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1 0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6-13.3 0-24-10.7-24-24v-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1 0-8.4-6.8-15.1-15.1-15.1h-58.3c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1-64 0"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216m256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7l233.4-233.3c12.5-12.5 32.8-12.5 45.3 0z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M480 32c0-12.9-7.8-24.6-19.8-29.6S434.5.2 425.3 9.3L381.7 53c-48 48-113.1 75-181 75H64c-35.3 0-64 28.7-64 64v96c0 35.3 28.7 64 64 64v128c0 17.7 14.3 32 32 32h64c17.7 0 32-14.3 32-32V352h8.7c67.9 0 133 27 181 75l43.6 43.6c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V300.3c18.6-8.8 32-32.5 32-60.4s-13.4-51.6-32-60.4zm-64 76.7v262.6C357.2 317.8 280.5 288 200.7 288H192v-96h8.7c79.8 0 156.5-29.8 215.3-83.3"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7.2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8.2-40.1l216-368C228.7 39.5 241.8 32 256 32m0 128c-13.3 0-24 10.7-24 24v112c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24m32 224a32 32 0 1 0-64 0 32 32 0 1 0 64 0"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/theme.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#what-yaml-can-do-now" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="YS — YAML without Limits" class="md-header__button md-logo" aria-label="YS — YAML without Limits" data-md-component="logo">
      
  <img src="../../images/yamlscript-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            YS — YAML without Limits
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The Kubernetes Effect
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/yaml/yamlscript" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../doc/" class="md-tabs__link">
          
  
    
  
  Documentation

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../press/" class="md-tabs__link">
        
  
    
  
  Press

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../community/" class="md-tabs__link">
          
  
    
  
  Community

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="YS — YAML without Limits" class="md-nav__button md-logo" aria-label="YS — YAML without Limits" data-md-component="logo">
      
  <img src="../../images/yamlscript-logo.svg" alt="logo">

    </a>
    YS — YAML without Limits
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/yaml/yamlscript" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../doc/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducing YS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YS by Example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/exercism/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Learn at YS Exercism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/cheat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YS Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/ys/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The `ys` Command
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/loaders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YS Loader Libraries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing YS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/clj-to-ys/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clojure to YS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/yaml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAML Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/clojure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clojure Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/yes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YeS Expressions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/modes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YS Modes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Control Flow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/operators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/chain/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dot Chaining
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/ys-taptest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unit Testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/ys-std/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YS Standard Library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core Library Essentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/ys-libs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Builtin Internal Libraries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/binary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compiling YS to Binary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../doc/run-ys/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Self Installation Scripts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    The Kubernetes Effect
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    The Kubernetes Effect
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-yaml-can-do-now" class="md-nav__link">
    <span class="md-ellipsis">
      What YAML Can Do Now
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external-and-internal-data-sources" class="md-nav__link">
    <span class="md-ellipsis">
      External (and Internal) Data Sources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inline-code-in-data-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Inline Code in Data Mode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-i-merge-thee" class="md-nav__link">
    <span class="md-ellipsis">
      How Do I merge Thee?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditional-insertions-in-mappings-and-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      Conditional Insertions in Mappings and Sequences
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2024-11-05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The Fall of YAMLScript!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2024-07-17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go Julia!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2024-06-20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dr. StrangeYAML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Older
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Older
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2024-04-16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YS Spring Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2024-03-14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YS Firsts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    2023 Advent Posts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            2023 Advent Posts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-24/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wrapped and Ready
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-23/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Perl to Rust
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-22/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flip Flops
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAML, Python and the Holy Graal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-20/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Godspeed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-19/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reindeer All The Way Down
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Santa's in d'buggy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rosetta Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Let Lambda Come Over
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Naughty is Nice!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stocking Stuffers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History Lesson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Future Proof
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The YeS Express
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    States and Ladders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coding with Style
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Going to the Library
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-07/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sharpen Your Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modes of Transportation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unwrapping Gifts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Santa's Big Secret
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Load em Up!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Twas a Bit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advent-2023/dec-01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YS Advent 2023
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../press/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Press
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../community/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Community
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Community
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing to YS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../social/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YS Social
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-yaml-can-do-now" class="md-nav__link">
    <span class="md-ellipsis">
      What YAML Can Do Now
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#external-and-internal-data-sources" class="md-nav__link">
    <span class="md-ellipsis">
      External (and Internal) Data Sources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inline-code-in-data-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Inline Code in Data Mode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-i-merge-thee" class="md-nav__link">
    <span class="md-ellipsis">
      How Do I merge Thee?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conditional-insertions-in-mappings-and-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      Conditional Insertions in Mappings and Sequences
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
<!-- pre>
page: >>><<<
page.meta: >>>{
  "title": "The Kubernetes Effect"
}<<<
page.previous_page: >>>Page(title='Self Installation Scripts', url='/doc/run-ys/')<<<
page.next_page: >>>Page(title='The Fall of YAMLScript!', url='/blog/2024-11-05/')<<<
scheme: >>>default<<<
tag: >>><<<
title: >>><<<
app: >>><<<
author: >>><<<
url: blog/2024-11-29/
edit_uri: https://github.com/yaml/yamlscript/edit/web-site/
src_path: blog/2024-11-29.md
</pre -->




  



  <a href="https://github.com/yaml/yamlscript/edit/web-site/blog/2024-11-29.md"
     title="Edit this page"
     class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
  </a>

  <a href="https://github.com/yaml/yamlscript/raw/web-site/blog/2024-11-29.md"
     title="View source of this page"
     class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg>
  </a>


  <h1>The Kubernetes Effect</h1>

<p>In my many years of creating Open Source software and talking about it at
conferences, some of the most productive development times are often those
leading up to the presentation.</p>
<p>In the last post, I mentioned that I was going to present a
<a href="https://yamlscript.org/kubeys24">90 minute YS tutorial&nbsp;⧉</a> at
<a href="https://events.linuxfoundation.org/kubecon-cloudnativecon-north-america/">KubeCon (November 15th in Salt Lake City)&nbsp;⧉</a>.</p>
<p>The conference was amazing and the YS tutorial was a huge success.
I came away with the feeling that YAML and YS had found their community.
<strong>KubeCon felt like YAMLCon</strong>!</p>
<p>But today's post is about the work leading up to the conference and the new data
oriented features that were added to YS as a result.</p>
<p>At the start of October we realized there were a few things we wanted to add to
the language to make it great for defining dynamic data in YAML files.</p>
<p>YS is a complete programming language and while you could already do almost
anything with it, we knew that it had blend smoothly into the existing YAML
files that people use for Kubernetes and other uses.
We started by focusing on Helm charts, and seeing how well YS could fit along
side the Go templating system (or replace it entirely).
In the end it all worked out very well, but a few things needed to be added
before tutorial time.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>TL;DR for Helm Users:</strong> <a href="https://yamlscript.org/doc/helmys">https://yamlscript.org/doc/helmys&nbsp;⧉</a></p>
</div>
<p>In this post I want to cover some of the new (and old) features of YS that you
can use to do cool things in your YAML files that are not possible with YAML
alone.
And remember, your YAML files are already valid YS files; but if you load them
(or preprocess them) with YS, you can do a lot more in there.</p>
<h2 id="what-yaml-can-do-now">What YAML Can Do Now</h2>
<p>YAML 1.2 has a few things that let you do things a bit fancier than with a data
only format like JSON:</p>
<ul>
<li>YAML has anchors and aliases for reusing specific nodes by naming them, and
  then later referring to them by name.</li>
<li>YAML has a special <code>&lt;&lt;</code> "merge key" that you can use to merge mappings.
  This was actually removed from the 1.2 spec but many popular implementations
  still support it (albeit with inconsistent behavior between implementations).</li>
<li>YAML allows you to tag nodes and this can sometimes be used creatively, though
  not consistently across different YAML implementations.</li>
<li>YAML supports multiple "documents" in a single file or stream, although
  unfortunately the spec doesn't allow you to alias nodes across documents.</li>
</ul>
<p>YS supports all of these features too.
It needs to since it claims to support the current YAML files of the world.
But YS being a complete programming language lets you go so much
further!</p>
<p>Let's take a closer look…</p>
<h2 id="external-and-internal-data-sources">External (and Internal) Data Sources</h2>
<p>Even though YAML lets you reuse nodes by name, those nodes need to be part of
your YAML document.
Say you have a section at the top of your YAML file that defines some default
values and names them with anchors, to be aliased later throughout the file.</p>
<p>This is problematic because the node of defaults is also going to be a part of
your data when you load it.
It would be nice if you could have 2 documents in a YAML file where you define
the data sources to be referred to in the first document, and then refer to them
in the second document.
If the loader returned the final (second) document then you could get the data
you wanted without also getting the data that you don't.</p>
<p>Let's try it out:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># file.yaml</span>
<span class="nn">---</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nl">&amp;map1</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bobbi Datamon</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nl">&amp;list1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fun</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">games</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">more</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stuff</span>

<span class="nn">---</span><span class="w"> </span><span class="nt">!yamlscript/v0</span><span class="p">:</span>
<span class="nt">person</span><span class="p">:</span>
<span class="w">  </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*map1</span>
<span class="w">  </span><span class="nt">likes</span><span class="p">:</span><span class="w"> </span><span class="nv">*list1</span>
</code></pre></div>
<p>Now we can load it with the YS command line interpreter, <code>ys</code>:</p>
<div class="highlight"><pre><span></span><code>$ ys --load file.yaml
{&quot;person&quot;:{&quot;name&quot;:&quot;Bobbi Datamon&quot;,&quot;likes&quot;:[&quot;fun&quot;,&quot;games&quot;]}}
</code></pre></div>
<p>Looks like it worked, but <code>ys --load</code> prints the result in compact JSON.
Before we discuss what happened, let's show the result in YAML:</p>
<div class="highlight"><pre><span></span><code>$ ys --load --yaml file.yaml
person:
  name: Bobbi Datamon
  likes:
  - fun
  - games
</code></pre></div>
<p>Nice!
<code>ys --load</code> gave us the data from the final document that included data from the
first document.</p>
<p></p><details style="background-color:#eee"><summary><strong><em>
More about loading YS</em></strong></summary></p>
<p>You can just use <code>ys --yaml</code> (or even <code>ys -Y</code>) instead of <code>ys --load --yaml</code>.
Use <code>-J</code> (for <code>--json</code>) to format <code>--load</code> output as a prettier JSON.</p>
<p>The YS "load" operation defaults to JSON because it is designed to output data
in an interoperable form.
JSON is very interoperable and the JSON data model is a subset of the YAML data
model.</p>
<p>Instead of using <code>ys</code> to load YAML/YS files, you can use a YS library to
replace other YAML loaders in
<a href="../../doc/bindings/">10 (and counting) common programming languages</a>, including
Python, Go, Ruby, Rust, Java and JavaScript.</p>
<p>For example, in Python you could do this:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">yamlscript</span><span class="w"> </span><span class="kn">import</span> <span class="n">YAMLScript</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">YAMLScript</span><span class="p">()</span>
<span class="n">text</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;db-config.yaml&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">ys</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>
<p>and similar in any other language that has a YS binding library.</p>
<p></details><p></p></p>
<p>The careful reader will have noticed that we broke the rules of YAML.
We aliased  nodes that were anchored in a different document.
What's up?</p>
<p>Well, the two YS documents each have a different <a href="../../doc/modes/">YS mode</a>
and that makes things work differently.</p>
<p>The first document has no <code>!yamlscript/v0</code> tag and thus is in "bare mode".
In bare mode all the rules are the same as YAML 1.2 (using the Core schema).</p>
<p>The second document has the <code>!yamlscript/v0:</code> tag.
The <code>!yamlscript/v0</code> tag tells YS that the document is in "code mode"
(the content starts as code but can switch to data mode at any time).
The <code>:</code> in <code>!yamlscript/v0:</code> tells YS to switch to data mode right away.</p>
<p>In code mode and data mode, aliases are very different than in bare mode.
They can access anchored nodes in the same document or any previous document.
Not only that, you can access parts of the anchored node with a path syntax.
For instance <code>*map1.name</code> would produce the string "Bobbi Datamon" and
<code>*list1.1</code> would produce the string "games".</p>
<p>That means that this works the same way as the previous example:</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span><span class="w"> </span><span class="nl">&amp;data</span>
<span class="nt">map1</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bobbi Datamon</span>
<span class="nt">list1</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fun</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">games</span>
<span class="nt">more</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stuff</span>

<span class="nn">---</span><span class="w"> </span><span class="nt">!yamlscript/v0</span><span class="p">:</span>
<span class="nt">person</span><span class="p">:</span>
<span class="w">  </span><span class="nt">&lt;&lt;:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-*data.map1</span>
<span class="w">  </span><span class="nt">likes:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-*data.list1</span>
</code></pre></div>
<p>Here we only anchored the entire first document and then used the path syntax to
access the parts we wanted.
Note that to do this we used <code>::</code> to switch to code mode and we also needed to
used <code>-</code> to escape the values and have them be treated as YS expressions.</p>
<p>YS has special <code>+++</code> symbol that evaluates to an array of all the prior
documents in the stream.
That means we don't need anchors at all:</p>
<div class="highlight"><pre><span></span><code><span class="nt">map1</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bobbi Datamon</span>
<span class="nt">list1</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fun</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">games</span>
<span class="nt">more</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stuff</span>

<span class="nn">---</span><span class="w"> </span><span class="nt">!yamlscript/v0</span><span class="p">:</span>
<span class="nt">person</span><span class="p">:</span>
<span class="w">  </span><span class="nt">&lt;&lt;:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">+++.last().map1</span>
<span class="w">  </span><span class="nt">likes:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">+++.$.list1</span>
</code></pre></div>
<p>The <code>+++.last()</code> function returns the last document in the stream so far (the
first document in this case)
The <code>+++.$</code> is a shorthand for <code>+++.last()</code>.</p>
<p>Another approach to take here is to make the first document use YS in code mode
and define variables to use in the second document:</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span><span class="w"> </span><span class="kt">!yamlscript/v0</span>
<span class="nt">map1 =:</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bobbi Datamon</span>
<span class="nt">list1 =:</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fun</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">games</span>

<span class="nn">---</span><span class="w"> </span><span class="nt">!yamlscript/v0</span><span class="p">:</span>
<span class="nt">person</span><span class="p">:</span>
<span class="w">  </span><span class="nt">&lt;&lt;:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map1</span>
<span class="w">  </span><span class="nt">likes:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">list1</span>
</code></pre></div>
<p>We use <code>=:</code> for assignment expressions in YS.
And <code>=::</code> does the same thing but toggles the mode of the value.</p>
<p>What if <code>list1</code> was a huge list and you really wanted to keep it in a separate
file?</p>
<p>No problem:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># big-list.yaml</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fun</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">games</span>
<span class="c1"># ...</span>
</code></pre></div>
<p>Now we just change the first document to load the list from the file:</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span><span class="w"> </span><span class="kt">!yamlscript/v0</span>
<span class="nt">map1 =:</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bobbi Datamon</span>
<span class="nt">list1 =</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">load(&#39;big-list.yaml&#39;)</span>
</code></pre></div>
<p>Not only can we access external data from a file, YS supports fetching
data from the web with the <code>curl</code> function and also getting data from databases!</p>
<h2 id="inline-code-in-data-mode">Inline Code in Data Mode</h2>
<p>We can do the same things in a single data mode document.
The trick is that we need to have a way to evaluate code in a way that doesn't
affect the data.</p>
<p>The <code>::</code> syntax is our new friend here.</p>
<p>This lets us do code things like define variables and even define new functions
in a way that doesn't affect the data we are defining.</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span><span class="w"> </span><span class="nt">!yamlscript/v0</span><span class="p">:</span>
<span class="nt">:</span><span class="p">:</span>
<span class="w">  </span><span class="nt">defn flip(array)</span><span class="p">:</span>
<span class="w">    </span><span class="nt">reverse</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">array</span>

<span class="w">  </span><span class="nt">map1 =:</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bobbi Datamon</span>
<span class="w">  </span><span class="nt">list1 =</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">load(&quot;big-list.yaml&quot;)</span>

<span class="nt">person</span><span class="p">:</span>
<span class="w">  </span><span class="nt">&lt;&lt;:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map1</span>
<span class="w">  </span><span class="nt">likes:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">list1:flip</span>
</code></pre></div>
<p>We defined a new function called <code>flip</code> which is a bit contrived since we could
have called <code>reverse</code> directly; but it proves the point.</p>
<p>We also defined our data variables.
We can actually define variables without <code>::</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span><span class="w"> </span><span class="nt">!yamlscript/v0</span><span class="p">:</span>
<span class="nt">map1 =:</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bobbi Datamon</span>
<span class="nt">list1 =</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">load(&quot;big-list.yaml&quot;)</span>

<span class="nt">person</span><span class="p">:</span>
<span class="w">  </span><span class="nt">&lt;&lt;:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map1</span>
<span class="w">  </span><span class="nt">likes:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">list1</span>
</code></pre></div>
<p>In a big document, it's sometimes nice to define the data variables closer to
where they are used.</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span><span class="w"> </span><span class="nt">!yamlscript/v0</span><span class="p">:</span>
<span class="nt">map1 =:</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bobbi Datamon</span>

<span class="nt">person</span><span class="p">:</span>
<span class="w">  </span><span class="nt">&lt;&lt;:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map1</span>
<span class="w">  </span><span class="nt">list1 =</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">load(&quot;big-list.yaml&quot;)</span>
<span class="w">  </span><span class="nt">likes:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">list1</span>
</code></pre></div>
<p>In fact, since we only use <code>map1</code> and <code>list1</code> once, we could have just inlined
them:</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span><span class="w"> </span><span class="nt">!yamlscript/v0</span><span class="p">:</span>
<span class="nt">person</span><span class="p">:</span>
<span class="w">  </span><span class="nt">&lt;&lt;</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bobbi Datamon</span>
<span class="w">  </span><span class="nt">likes:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">load(&quot;big-list.yaml&quot;)</span>
</code></pre></div>
<h2 id="how-do-i-merge-thee">How Do I <code>merge</code> Thee?</h2>
<p>Let me count the ways :)</p>
<p>We are still using the <code>&lt;&lt;</code> merge key to merge mappings, but YS has a standard
<code>merge</code> function (among 100s of others).</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span><span class="w"> </span><span class="nt">!yamlscript/v0</span><span class="p">:</span>
<span class="nt">map1 =:</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bobbi Datamon</span>
<span class="nt">list1 =</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">load(&quot;big-list.yaml&quot;)</span>

<span class="nt">person:</span><span class="p">:</span>
<span class="w">  </span><span class="nt">merge:</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">likes:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">list1</span>
</code></pre></div>
<p>Note the <code>!</code> in front of <code>map1</code>.
It toggles from data mode to code mode.
We need to use <code>!</code> for that purpose in data mode sequences.
For mappings we can use <code>key:: variable</code> but it is just a shorthand for
<code>key: ! variable</code>.</p>
<p>Another way to write that is:</p>
<div class="highlight"><pre><span></span><code><span class="nt">person:</span><span class="p">:</span>
<span class="w">  </span><span class="nt">merge map1:</span><span class="p">:</span>
<span class="w">    </span><span class="nt">likes:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">list1</span>
</code></pre></div>
<p>Since the <code>merge</code> key is already in code mode we can just put the <code>map1</code>
variable there.</p>
<p>Sometimes you want to use a function like <code>merge</code> without needing to further
indent the data you are applying the function to.</p>
<p>YS lets you put a function in a tag if you prefix it with a<code>:</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span><span class="w"> </span><span class="nt">!yamlscript/v0</span><span class="p">:</span>
<span class="nt">map1 =:</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bobbi Datamon</span>
<span class="nt">list1 =</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">load(&quot;big-list.yaml&quot;)</span>

<span class="nt">person</span><span class="p">:</span><span class="w"> </span><span class="kt">!:merge</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map1</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">likes:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">list1</span>
</code></pre></div>
<h2 id="conditional-insertions-in-mappings-and-sequences">Conditional Insertions in Mappings and Sequences</h2>
<p>A big missing feature (and one definitely needed for Helm charts) was the
ability to conditionally insert key/value pairs into mappings depending on some
value being true or false.</p>
<p>Functionally that's a bit weird for a data language.
You can always apply any function to any data node to change its value, but how
do you make it control whether or not it exists at all?</p>
<p>You really need to apply a function to its parent mapping to make that happen…</p>
<p>…or do you?</p>
<p>YS ended up solving this using the <code>::</code> syntax, with a special rule.</p>
<div class="highlight"><pre><span></span><code>!yamlscript/v0:
foo: 111
::
  when a &gt; b::
    bar: 222
baz: 333
</code></pre></div>
<p>The rule is that if the code under <code>::</code> evaluates to nil then ignore it.
If it evaluates to a mapping then merge it into the parent mapping.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>when</code> function returns nil if the condition is false, and the body
evaluation value if it is true.</p>
</div>
<p>To best understand this we can simply compile this YS to Clojure code.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ys<span class="w"> </span>-U<span class="w"> </span>--compile<span class="w"> </span>file.yaml<span class="w">  </span><span class="c1"># or -c</span>
<span class="o">(</span>merge<span class="w"> </span><span class="o">{</span><span class="s2">&quot;foo&quot;</span><span class="w"> </span><span class="m">111</span><span class="o">}</span><span class="w"> </span><span class="o">(</span>merge<span class="w"> </span><span class="o">(</span>when<span class="w"> </span><span class="o">(</span>&gt;<span class="w"> </span>a<span class="w"> </span>b<span class="o">)</span><span class="w"> </span><span class="o">{</span><span class="s2">&quot;bar&quot;</span><span class="w"> </span><span class="m">222</span><span class="o">})</span><span class="w"> </span><span class="o">{</span><span class="s2">&quot;baz&quot;</span><span class="w"> </span><span class="m">333</span><span class="o">}))</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should know by now that every YS program is compiled to Clojure code
and then evaluated.
Well, data files that use YS are no different!</p>
</div>
<p>Given that <code>merge</code> ignores nil values, this is exactly what we want.</p>
<p>As we worked through the standard Helm templates we found that while this
worked just fine, it was a bit verbose.
We "fixed" that by letting you put the condition test "inside" the <code>::</code> key:</p>
<div class="highlight"><pre><span></span><code>!yamlscript/v0:
foo: 111
:when rand(100) &gt; 50::
  bar: 222
baz: 333
</code></pre></div>
<p>I've changed <code>a &gt; b</code> here to something you could actually run yourself.
Note that before we never defined <code>a</code> or <code>b</code>, so that would have failed.</p>
<p>We can even get this into a single line by using YAML's flow style:</p>
<div class="highlight"><pre><span></span><code>!yamlscript/v0:
foo: 111
:when rand(100) &gt; 50:: {bar: 222}
baz: 333
</code></pre></div>
<p>Nice!</p>
<p>Now that you are up to speed, take a look at this page that shows how to
completely convert a stock Helm chart to use YS instead of Go templating:
<a href="https://yamlscript.org/doc/helmys">https://yamlscript.org/doc/helmys&nbsp;⧉</a></p>
<p>After the KubeCon we realized that this was also needed for sequences.
You should be able to conditionally insert items into a sequence at any point.</p>
<p>All you need to do is use all of the above on a <code>- ...</code> sequence entry
(returning a sequence or nil):</p>
<div class="highlight"><pre><span></span><code>!yamlscript/v0:
- aaa
- :when rand(100) &gt; 50::
  - foo
  - bar
- zzz
</code></pre></div>
<p>Again let's compile this to Clojure code to see exactly what it does:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ys<span class="w"> </span>-c<span class="w"> </span>file.yaml
<span class="o">(</span>concat<span class="w"> </span><span class="o">[</span><span class="s2">&quot;aaa&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">(</span>concat<span class="w"> </span><span class="o">(</span>when<span class="w"> </span><span class="o">(</span>&gt;<span class="w"> </span><span class="o">(</span>rand<span class="w"> </span><span class="m">100</span><span class="o">)</span><span class="w"> </span><span class="m">50</span><span class="o">)</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;foo&quot;</span><span class="w"> </span><span class="s2">&quot;bar&quot;</span><span class="o">])</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;zzz&quot;</span><span class="o">]))</span>
</code></pre></div>
<p>Similar to the mapping case, but we get <code>concat</code> instead of <code>merge</code> to do the
right thing with sequences.</p>
<p>Now we run it a couple times:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ys<span class="w"> </span>-Y<span class="w"> </span>file.yaml
-<span class="w"> </span>aaa
-<span class="w"> </span>zzz
$<span class="w"> </span>ys<span class="w"> </span>-Y<span class="w"> </span>file.yaml
-<span class="w"> </span>aaa
-<span class="w"> </span>foo
-<span class="w"> </span>bar
-<span class="w"> </span>zzz
</code></pre></div>
<p>and Voilà!</p>
<h2 id="conclusion">Conclusion</h2>
<p>I hope this post gave you some good ideas about how cleanly you can extend your
YAML data files with YS.
And also how this is applicable today in major YAML consumers like Helm.</p>
<p><a href="https://github.com/yaml/yamlscript/issues">Please let us know&nbsp;⧉</a> where YS can be
made even better.</p>
<p><strong>That's our goal!</strong></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../doc/run-ys/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Self Installation Scripts">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Self Installation Scripts
              </div>
            </div>
          </a>
        
        
          
          <a href="../2024-11-05/" class="md-footer__link md-footer__link--next" aria-label="Next: The Fall of YAMLScript!">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                The Fall of YAMLScript!
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      YS / YAMLScript — Copyright 2022-2025
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.action.view", "content.code.copy", "header.autohide", "navigation.footer", "navigation.indexes", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>