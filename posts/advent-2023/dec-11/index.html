<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://yamlscript.org/posts/advent-2023/dec-11/"><link href="/assets/main.7eeaf7bb0c5b5da98e70.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>The YeS Express | YAMLScript</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="The YeS Express"><meta property="og:site_name" content="YAMLScript"><meta property="og:type" content="website"><meta property="og:url" content="https://yamlscript.org/posts/advent-2023/dec-11/"><meta name="twitter:card" content="summary_large_image"><meta name="description" content="The YeS Express by Ingy döt Net | 11 Dec 2023 | 4 min read Santa&#39;s got a lot of ground to cover in a short amount of time. He doesn&#39;t have..."><meta property="og:description" content="The YeS Express by Ingy döt Net | 11 Dec 2023 | 4 min read Santa&#39;s got a lot of ground to cover in a short amount of time. He doesn&#39;t have..."><meta name="description" content="The YeS Express by Ingy döt Net | 11 Dec 2023 | 4 min read Santa&#39;s got a lot of ground to cover in a short amount of time. He doesn&#39;t have..."><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/"><img src="/images/yamlscript.svg"></a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/about">About</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>The YeS Express</h1><div class="post__details">by <a href="/about/#ingydotnet">Ingy döt Net</a> <span>| </span><time datetime="2023-12-11">11 Dec 2023 </time><span>| </span><span>4 min read</span></div></header><main class="post__content"><p>Santa's got a lot of ground to cover in a short amount of time. He doesn't have time to deal with confusing maps and directions.</p><p>Lisp has other-worldly powers of abstraction, but when it comes to reading syntax, most people prefer the familiarity of this world.</p><p>YAMLScript fully embraces all that Clojure has to offer, but syntax-wise it also offers a more familiar face.</p><h3>Welcome to Day 11 of the YAMLScript Advent Calendar!</h3><p>Today we'll look at YAMLScript Expressions, aka YeS-Expressions. Lisp has S-Expressions, YAMLScript has YeS-Expressions!</p><p>When writing YAMLScript instructions in &quot;code mode&quot; you are always working with 3 basic YAML elements:</p><ul><li>YAML Block Mappings - The indented style <code>key: value</code> pairs</li><li>YAML Quoted Scalars - String literals</li><li>YAML Plain Scalars - The unquoted <code>value</code> scalars</li></ul><p>YAMLScript treats all YAML plain scalars as YeS-Expressions (ysexprs).</p><p>Let's look at some examples.</p><h3>Infix Expressions</h3><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">x =</span><span class="token punctuation">:</span> (y * 2)<br><span class="token key atrule">z =</span><span class="token punctuation">:</span> (x + 5 + y)</code></pre><p>Compiles to Clojure (Lisp) like this:</p><pre class="language-clojure"><code class="language-clojure"><span class="token punctuation">(</span><span class="token keyword">def</span> x <span class="token punctuation">(</span><span class="token keyword">*</span> y <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">(</span><span class="token keyword">def</span> z <span class="token punctuation">(</span><span class="token keyword">+</span> x <span class="token number">5</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>YeS-Expressions support infix operators for very simple expressions. If you put exactly 3 forms in parentheses, and the second one is an operator, then the first and third forms are operands. The compiler will swap the first and second forms making it work like Lisp wants it to.</p><p>If you have a parenthesized expression with more than 2 operands and the operators are all the same, then the compiler will make a Lisp form starting with the operator and followed by the operands.</p><blockquote><p>Note: In rare cases in Lisp <code>(a + 1)</code> is valid when <code>a</code> is a function that takes two arguments, an operator function add a number in this case. There are ways to specifiy this in YAMLScript, but we won't cover them here.</p></blockquote><p>In simple cases where the infix expression is the only thing in the YAML scalar, you can omit the parentheses.</p><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">x =</span><span class="token punctuation">:</span> y * 2<br><span class="token key atrule">z =</span><span class="token punctuation">:</span> x + 5 + y</code></pre><p>Note that YAMLScript has no support for operator precedence. You must use parentheses to group expressions and group operations in triplets.</p><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">x =</span><span class="token punctuation">:</span> ((y * 2) + 5) / 2</code></pre><h3>Prefix Expressions</h3><p>In Lisp you might see a function call like this:</p><pre class="language-clojure"><code class="language-clojure"><span class="token punctuation">(</span><span class="token function">abspath</span> <span class="token punctuation">(</span><span class="token keyword">join</span> <span class="token string">"/"</span> <span class="token punctuation">[</span><span class="token string">"foo"</span> <span class="token string">"bar"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>Many non-Lisp languages would write this as:</p><pre class="language-javascript"><code class="language-javascript"><span class="token function">abspath</span><span class="token punctuation">(</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"foo"</span><span class="token punctuation">,</span> <span class="token string">"bar"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>YAMLScript supports this style of function call as well.</p><p>YAMLScript is very flexible about how you can write function calls. You could do the above in all the ways below:</p><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">path1 =</span><span class="token punctuation">:</span> abspath(join("/" <span class="token punctuation">[</span>"foo" "bar"<span class="token punctuation">]</span>))<br><span class="token key atrule">path2 =</span><span class="token punctuation">:</span> (abspath (join "/" <span class="token punctuation">[</span>"foo" "bar"<span class="token punctuation">]</span>))<br><span class="token key atrule">path3 =</span><span class="token punctuation">:</span><br>  <span class="token key atrule">abspath</span><span class="token punctuation">:</span><br>    <span class="token key atrule">join "/"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>"foo" "bar"<span class="token punctuation">]</span><br><span class="token key atrule">=></span><span class="token punctuation">:</span> (def path4 abspath(join("/" <span class="token punctuation">[</span>"foo" "bar"<span class="token punctuation">]</span>)))</code></pre><p>Look closely at the last example (<code>path4</code>). It looks like a Clojure form, but it actually makes use of prefix function calls.</p><h3>Special Operators</h3><p>YAMLScript has a few special operators that are not part of Clojure.</p><p>The <code>..</code> operator is used to create a range of consectutive integers. The expression <code>(1 .. 3)</code> is equivalent to the Clojure form <code>(range 1 4)</code> and evaluates to the list <code>(1 2 3)</code>. The expression <code>(3 .. 1)</code> is equivalent to the Clojure form <code>(range 3 0 -1)</code> and evaluates to the list <code>(3 2 1)</code>.</p><p>The <code>+</code> and <code>*</code> operators are polymorphic.</p><ul><li><code>&quot;x&quot; * 3</code> -&gt; <code>&quot;xxx&quot;</code></li><li><code>&quot;x&quot; + &quot;y&quot; + &quot;z&quot;</code> -&gt; <code>&quot;xyz&quot;</code></li><li><code>{a: 1} + {b: 2}</code> -&gt; <code>{a: 1, b: 2}</code></li><li><code>[1 2] + [3 4]</code> -&gt; <code>[1 2 3 4]</code></li></ul><h3>Special Thanks</h3><p>I'd like to say thank you to David A. Wheeler for his web page <a href="https://dwheeler.com/readable/sweet-expressions.html">Curly infix, Modern-expressions, and Sweet-expressions: A suite of readable formats for Lisp-like languages</a>.</p><p>I adapted many of those ideas to make YeS-Expressions.</p><h3>Conclusion</h3><p>As I've said before, YAMLScript is very flexible, allowing you to decide how much Lisp or YAML style you want to use at any point. YeS-Expressions allow you to lean to the Lisp but keep it readable for your non-Lisper friends.</p><p>Join me tomorrow for Day 12 of the YAMLScript Advent Calendar.</p><p>&nbsp;</p><details><summary style="color:#888">Santa's little secrets...</summary><p>In December 2023 YAMLScript is a work in progress.</p><p>This is not to say that it's vaporware, or a toy proof of concept. It has a working compiler, runtime and CLI. It has unit tests that must pass for every commit pushed to the main branch. It's well thought out and has a clear direction that I continually vet with a small group of talented and trusted people.</p><p>But that in turn not to say that you should use it in production today. I encourage you to start playing with it, and I'm committed to backwards compatibility for stable releases. But we're not quite there yet. Caveat usor!</p><p>YAMLScript is evolving fast. While I'm writing these posts, I'm also writing the code for new features and fixing bugs as I go. I've had the Advent plan for over a month now, and I had planned to be further along before December 1st, but such are the time estimates of hackers.</p><p>I am attempting to make sure that the code examples in these posts are always using the implemented features, but sometimes I may fall a few hours behind. Often I need to write the examples using code patterns that actually work but are not the ones I preferred to best make a point.</p><p>As I fix bugs, implement features and tweak the language, I will update the posts accordingly. If you see something that bugs you, try taking another look after a few days. It probably bugged me too!</p><p>Be patient with me.</p><p>If I had to guess, I'd say that YAMLScript v0 will be have a stable release sometime before March 2024. I'll continue blogging the progress as I go, so it shouldn't be hard for you to decide when to start using YAMLScript for real.</p><p>Overall the whole thing is going extremely well, and I'm having a lot of fun. It's important to be transparent with you about where things are at.</p><p>Stick with me... This is going to be awesome!</p><p>— Ingy döt Net</p></details></main><aside class="post__aside"><div class="post__tags"><a href="/tags/blog/">#blog</a> <a href="/tags/advent-2023/">#advent-2023</a></div><nav class="post__pagination"><a href="/posts/advent-2023/dec-10/"><span>←</span> <span>States and Ladders</span> </a><a href="/posts/advent-2023/dec-12/"><span>Future Proof</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a href="https://github.com/yaml/yamlscript" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul><p class="footer__attribution">Powered by <a href="https://www.11ty.dev" target="_blank" rel="noopener">Eleventy</a>. Theme: <a href="https://github.com/yinkakun/eleventy-duo" target="_blank" rel="noopener noreferrer">Eleventy Duo</a>.</p></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>