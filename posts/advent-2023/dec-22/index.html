<!doctype html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-44C9DS3Q80"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-44C9DS3Q80');</script><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://yamlscript.org/posts/advent-2023/dec-22/"><link href="/assets/main.769d3d1b7edc71568d89.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>Flip Flops | YAMLScript</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="Flip Flops"><meta property="og:site_name" content="YAMLScript"><meta property="og:type" content="website"><meta property="og:url" content="https://yamlscript.org/posts/advent-2023/dec-22/"><meta name="twitter:card" content="summary_large_image"><meta name="description" content="Flip Flops by Ingy döt Net | 22 Dec 2023 | 3 min read Can you imagine Santa walking around in flip flops? I&#39;ve never been up to the North..."><meta property="og:description" content="Flip Flops by Ingy döt Net | 22 Dec 2023 | 3 min read Can you imagine Santa walking around in flip flops? I&#39;ve never been up to the North..."><meta name="description" content="Flip Flops by Ingy döt Net | 22 Dec 2023 | 3 min read Can you imagine Santa walking around in flip flops? I&#39;ve never been up to the North..."><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/"><img src="/images/yamlscript-logo.svg"></a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/doc">Docs</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/about">About</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>Flip Flops</h1><div class="post__details">by <a href="/about/#ingydotnet">Ingy döt Net</a> <span>| </span><time datetime="2023-12-22">22 Dec 2023 </time><span>| </span><span>3 min read</span></div></header><main class="post__content"><p>Can you imagine Santa walking around in flip flops? I've never been up to the North Pole, but I'm pretty sure there's no beaches. I always pictured Santa wearing moon boots around the workshop.</p><p>YAMLScript on the other hand, is all about flip flops!</p><h3>Welcome to Day 22 of the YAMLScript Advent Blog!</h3><p>Remember way back in <a href="../dec-06/">Day 6</a> when we talked about the 3 different YAMLScript modes? They were <strong>bare</strong>, <strong>data</strong> and <strong>code</strong>. The bare mode was what you got then you ran (or loaded) a YAMLScript program with no <code>!yamlscript/v0</code> tag at the top. It just meant that you were effectively stuck in data mode, with no possibility of executing any code.</p><p>There's actually comfort in <strong>bare</strong> mode. You are using YAMLScript to process your data because it is one of the best YAML loaders available, but you don't have to worry about any code being run accidentally.</p><p>Today's post is about the other two modes. Either you are writing a program (thus starting in <strong>code</strong> mode) or you are doing cool stuff with your data files (thus starting in <strong>data</strong> mode).</p><p>In either case you are going to want to switch modes at various places in your YAMLScript. We learned before that you could switch modes by using the <code>!</code> tag. This is the smallest possible tag and we use it for the most common need.</p><p>Here's an example of using YAMLScript to generate data to be loaded. We'll start in code mode by using <code>!yamlscript/v0</code>:</p><pre class="language-yaml"><code class="language-yaml"><span class="token tag">!yamlscript/v0</span><br><br><span class="token key atrule">vars =</span><span class="token punctuation">:</span> <span class="token tag">!</span><br>  <span class="token key atrule">colors</span><span class="token punctuation">:</span><br>  <span class="token punctuation">-</span> red<br>  <span class="token punctuation">-</span> <span class="token tag">!</span> ("gre" + "en")<br>  <span class="token punctuation">-</span> blue<br>  <span class="token key atrule">numbers</span><span class="token punctuation">:</span> <span class="token tag">!</span><br>    <span class="token key atrule">vec</span><span class="token punctuation">:</span><br>      <span class="token key atrule">map \(% * 10)</span><span class="token punctuation">:</span> <span class="token tag">!</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><br>  <span class="token key atrule">awesome</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token key atrule">yaml</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token punctuation">,</span> <span class="token key atrule">xml</span><span class="token punctuation">:</span> <span class="token tag">!</span> (1 <span class="token punctuation">></span> 2) <span class="token punctuation">}</span><br><br><span class="token key atrule">=></span><span class="token punctuation">:</span> <span class="token tag">!</span><br><span class="token punctuation">-</span> <span class="token tag">!</span> <span class="token string">"$(vars.colors.1) with envy"</span><br><span class="token punctuation">-</span> <span class="token tag">!</span> <span class="token string">"Four score and $(vars.numbers.1) years ago"</span><br><span class="token punctuation">-</span> <span class="token tag">!</span> <span class="token string">"Santa wears flip flops. $(vars.awesome.yaml) or $(vars.awesome.xml)?"</span></code></pre><p>That's more bangs than a fireworks show in a barbershop!</p><p>This was just a crazy way to get the following data:</p><pre class="language-yaml"><code class="language-yaml"><span class="token punctuation">-</span> green with envy<br><span class="token punctuation">-</span> Four score and 20 years ago<br><span class="token punctuation">-</span> Santa wears flip flops. true or false<span class="token punctuation">?</span></code></pre><p>Every time you see a <code>!</code> tag, it means that we are switching modes from <code>code</code> to <code>data</code> or vice versa.</p><p>Let's walk through it:</p><ul><li><code>!yamlscript/v0</code> - This tag starts the program in <code>code</code> mode. If we wanted to start in <code>data</code> mode, we would use <code>!yamlscript/v0/data</code>.</li><li><code>vars =: !</code> - We are setting the value of a variable named <code>vars</code> to the some data we want to write in plain old YAML. Before we can do that, we need to switch to <code>data</code> mode.</li><li><code>! (&quot;gre&quot; + &quot;en&quot;)</code> - This is a YAMLScript expression that evaluates to the string <code>green</code>. To let YAMLScript know that we want to evaluate this expression, we switch back to <code>code</code> mode.</li><li><code>numbers: !</code> - Even though we just switched to <code>code</code> mode, in the previous point, it was only for that scalar / expression. We need to do it again since the mapping we are in is in data mode.</li></ul><p>And so on. Note that when we switch modes we do it only for that node, not for the whole rest of the document.</p><h3>A Better Flip Flop Syntax</h3><p>The <code>!</code> tag is ok for switching modes, but even though it's one character, I find it a bit noisy. Here's another way to switch modes:</p><pre class="language-yaml"><code class="language-yaml"><span class="token tag">!yamlscript/v0</span><br><br>vars =<span class="token punctuation">:</span><span class="token punctuation">:</span><br>  <span class="token key atrule">colors</span><span class="token punctuation">:</span><br>  <span class="token punctuation">-</span> red<br>  <span class="token punctuation">-</span> <span class="token tag">!</span> ("gre" + "en")<br>  <span class="token punctuation">-</span> blue<br>  numbers<span class="token punctuation">:</span><span class="token punctuation">:</span><br>    <span class="token key atrule">vec</span><span class="token punctuation">:</span><br>      map \(% * 10)<span class="token punctuation">:</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><br>  <span class="token key atrule">awesome</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token key atrule">yaml</span><span class="token punctuation">:</span> <span class="token boolean important">true</span><span class="token punctuation">,</span> xml<span class="token punctuation">:</span><span class="token punctuation">:</span> (1 <span class="token punctuation">></span> 2) <span class="token punctuation">}</span><br><br>=<span class="token punctuation">></span><span class="token punctuation">:</span><span class="token punctuation">:</span><br><span class="token punctuation">-</span> <span class="token tag">!</span> <span class="token string">"$(vars.colors.1) with envy"</span><br><span class="token punctuation">-</span> <span class="token tag">!</span> <span class="token string">"Four score and $(vars.numbers.1) years ago"</span><br><span class="token punctuation">-</span> <span class="token tag">!</span> <span class="token string">"Santa wears flip flops. $(vars.awesome.yaml) or $(vars.awesome.xml)?"</span></code></pre><p>When a <code>!</code> tag follows a <code>:</code> key/value separator, we can use a <code>::</code> instead to mean the same thing.</p><p>There are still bangs in there because they didn't follow a <code>:</code>.</p><hr><p>I find the <code>::</code> syntax to be a bit more readable.</p><p>Note that this isn't a special new YAML syntax. It's simply an unquoted key that ends with a colon.</p><p>This trick works from both code and data modes. It does not work from bare mode. You'll just have a mapping key that ends with a colon.</p><p>It might seem like using the <code>!</code> or <code>::</code> as a toggle could get confusing because you need to keep track of which mode you are in.</p><p>But typically it's pretty obvious for a person reading the YAML. Machines need to be more exact.</p><p>I suspect that I'll introduce the <code>!code</code> and <code>!data</code> tags in the future, for when you feel the need to be explicit.</p><hr><p>That was a quick post but also an important one for learning how to write better YAMLScript.</p><p>See you tomorrow for Day 23 of the YAMLScript Advent Blog!</p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/blog/">#blog</a> <a href="/tags/advent-2023/">#advent-2023</a></div><nav class="post__pagination"><a href="/posts/advent-2023/dec-21/"><span>←</span> <span>YAML, Python and the Holy Graal</span> </a><a href="/posts/advent-2023/dec-23/"><span>Perl to Rust</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a href="https://github.com/yaml/yamlscript" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul><p class="footer__attribution">Powered by <a href="https://www.11ty.dev" target="_blank" rel="noopener">Eleventy</a>. Theme: <a href="https://github.com/yinkakun/eleventy-duo" target="_blank" rel="noopener noreferrer">Eleventy Duo</a>.</p></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>