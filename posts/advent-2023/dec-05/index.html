<!doctype html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-44C9DS3Q80"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-44C9DS3Q80');</script><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://yamlscript.org/posts/advent-2023/dec-05/"><link href="/assets/main.769d3d1b7edc71568d89.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>Unwrapping Gifts | YAMLScript</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="Unwrapping Gifts"><meta property="og:site_name" content="YAMLScript"><meta property="og:type" content="website"><meta property="og:url" content="https://yamlscript.org/posts/advent-2023/dec-05/"><meta name="twitter:card" content="summary_large_image"><meta name="description" content="Unwrapping Gifts by Ingy döt Net | 05 Dec 2023 | 3 min read It&#39;s certainly a relief now that I&#39;ve told you the big secret about YAMLScript...."><meta property="og:description" content="Unwrapping Gifts by Ingy döt Net | 05 Dec 2023 | 3 min read It&#39;s certainly a relief now that I&#39;ve told you the big secret about YAMLScript...."><meta name="description" content="Unwrapping Gifts by Ingy döt Net | 05 Dec 2023 | 3 min read It&#39;s certainly a relief now that I&#39;ve told you the big secret about YAMLScript...."><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/"><img src="/images/yamlscript-logo.svg"></a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/doc">Docs</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/about">About</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>Unwrapping Gifts</h1><div class="post__details">by <a href="/about/#ingydotnet">Ingy döt Net</a> <span>| </span><time datetime="2023-12-05">05 Dec 2023 </time><span>| </span><span>3 min read</span></div></header><main class="post__content"><p>It's certainly a relief now that I've told you the big secret about YAMLScript. Now that you know that YAMLScript is really Clojure, I don't have to dance around the subject anymore. I didn't want to scare you away by going Full-Lisp on you from the start!</p><p>Now we can just get into it. We can write, run and load YAMLScript until the cows come home.</p><p>But wait... How do we do that? You don't even have YS installed yet!</p><h3>Welcome to Day 5 of the YAMLScript Advent Calendar</h3><p>Today we're going to learn how to install YAMLScript a couple different ways.</p><p>Luckily for you I just finished creating the <a href="https://github.com/yaml/yamlscript/releases/tag/0.1.20">first official YAMLScript release</a>. What a coincidence!</p><p>At he moment there are only releases published for Linux x86_64 and macOS aarch64. If you happen to be running on one of those platforms, you can run the following command to install YAMLScript's CLI, <code>ys</code>:</p><blockquote><p>UPDATE: Releases are now available for Linux and macOS on both x86_64 and aarch64 (for either). See the <a href="https://github.com/yaml/yamlscript/releases/">YAMLScript Releases Page</a></p></blockquote><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> https://yamlscript.org/install <span class="token operator">|</span> <span class="token function">bash</span></code></pre><p>This installer defaults to installing <code>ys</code> into <code>~/.local/bin</code>, unless you run it as root in which case it defautlls to <code>/usr/local/bin</code>.</p><p>If you want to install it somewhere else, like say <code>~/local/bin</code>, you can do:</p><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> https://yamlscript.org/install <span class="token operator">|</span> <span class="token assign-left variable">PREFIX</span><span class="token operator">=~</span>/local <span class="token function">bash</span></code></pre><p>Wherever you install it, make sure that the <code>$PREFIX/bin</code> directory is in your <code>PATH</code> environment variable.</p><p>YAMLScript also provides a release for <code>libyamlscript.so</code>, the YAMLScript shared library. You can install it like above but with (some variation of):</p><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> https://yamlscript.org/install <span class="token operator">|</span> <span class="token function">bash</span></code></pre><p>We'll be using the shared library soon when we start playing around with using YAMLScript from other programming languages.</p><h3>Building from Source</h3><p>The most reliable way to install YAMLScript is to build it from source. We've put a lot of effort into making this as easy as possible. You don't need any special prerequisites; just git, bash, curl and make.</p><p>The first thing you need to do is clone the YAMLScript repo:</p><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/yaml/yamlscript</code></pre><p>Then you can build and install the CLI with:</p><pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">cd</span> yamlscript<br>$ <span class="token function">make</span> build<br>$ <span class="token function">make</span> <span class="token function">install</span><br>or<br>$ <span class="token function">make</span> <span class="token function">install</span> <span class="token assign-left variable">PREFIX</span><span class="token operator">=</span><span class="token punctuation">..</span>.</code></pre><p>The <code>make install</code> command will install both <code>ys</code> and <code>libyamlscript.so</code> into <code>$PREFIX/bin</code> and <code>$PREFIX/lib</code> respectively.</p><p>YAMLScript has a pretty sophisticated build system, built around GNU Make. Even though the build uses Java, Clojure and GraalVM, you don't need to install any of those things. In fact, even if you have them installed, the build will ignore them.</p><h3>Running YAMLScript</h3><p>Now that you have YAMLScript installed, you can run it. Try:</p><pre class="language-bash"><code class="language-bash">$ ys <span class="token parameter variable">--help</span></code></pre><p>It should display:</p><pre class="language-text"><code class="language-text">ys - The YAMLScript (YS) Command Line Tool - v0.1.81<br><br>Usage: ys [<option...>] [<file>]<br><br>Options:<br><br>      --run                Run a YAMLScript program file (default)<br>  -l, --load               Output (compact) JSON of YAMLScript evaluation<br>  -e, --eval YSEXPR        Evaluate a YAMLScript expression<br>                           multiple -e values joined by newline<br><br>  -c, --compile            Compile YAMLScript to Clojure<br>  -b, --binary             Compile to a native binary executable<br><br>  -p, --print              Print the result of --run in code mode<br>  -o, --output FILE        Output file for --load, --compile or --binary<br><br>  -T, --to FORMAT          Output format for --load:<br>                             json, yaml, edn<br>  -J, --json               Output (pretty) JSON for --load<br>  -Y, --yaml               Output YAML for --load<br>  -E, --edn                Output EDN for --load<br>  -U, --unordered          Mappings don't preserve key order (faster)<br><br>  -m, --mode MODE          Add a mode tag: code, data, or bare (for -e)<br>  -C, --clojure            Treat input as Clojure code<br><br>  -d                       Debug all compilation stages<br>  -D, --debug-stage STAGE  Debug a specific compilation stage:<br>                             parse, compose, resolve, build,<br>                             transform, construct, print<br>                           can be used multiple times<br>  -S, --stack-trace        Print full stack trace for errors<br>  -x, --xtrace             Print each expression before evaluation<br><br>      --install            Install the libyamlscript shared library<br>      --upgrade            Upgrade both ys and libyamlscript<br><br>      --version            Print version and exit<br>  -h, --help               Print this help and exit</file></option...></code></pre><p>In the next day or two we'll go over all of these options in detail.</p><p>Here's a quick example of how to run YAMLScript to process a file from the internet that Google just told me about:</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> https://gist.githubusercontent.com/chriscowley/8598119/raw/8f671464f914320281e5e75bb8dcbe11285d21e6/nfs.example.lan.yml <span class="token operator">|</span><br>ys <span class="token parameter variable">-J</span> - <span class="token operator">|</span> jq .classes<br><span class="token punctuation">{</span><br>  <span class="token string">"nfs::server"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><br>    <span class="token string">"exports"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><br>      <span class="token string">"/srv/share1"</span>,<br>      <span class="token string">"/srv/share3"</span><br>    <span class="token punctuation">]</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>The special file name <code>-</code> tells <code>ys</code> to read the program from STDIN. The <code>-J</code> option tells <code>ys</code> to <code>--load</code> the YAMLScript and output the evaluation to JSON.</p><p>Well that's a wrap. Thanks again for following along each day.</p><p>I'll see you tomorrow for day 6 of YAMLScript Advent 2023!</p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/blog/">#blog</a> <a href="/tags/advent-2023/">#advent-2023</a></div><nav class="post__pagination"><a href="/posts/advent-2023/dec-04/"><span>←</span> <span>Santa&#39;s Big Secret</span> </a><a href="/posts/advent-2023/dec-06/"><span>Modes of Transportation</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a href="https://github.com/yaml/yamlscript" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul><p class="footer__attribution">Powered by <a href="https://www.11ty.dev" target="_blank" rel="noopener">Eleventy</a>. Theme: <a href="https://github.com/yinkakun/eleventy-duo" target="_blank" rel="noopener noreferrer">Eleventy Duo</a>.</p></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>