<!doctype html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-44C9DS3Q80"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-44C9DS3Q80');</script><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://yamlscript.org/posts/advent-2023/dec-09/"><link href="/assets/main.769d3d1b7edc71568d89.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>Coding with Style | YAMLScript</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="Coding with Style"><meta property="og:site_name" content="YAMLScript"><meta property="og:type" content="website"><meta property="og:url" content="https://yamlscript.org/posts/advent-2023/dec-09/"><meta name="twitter:card" content="summary_large_image"><meta name="description" content="Coding with Style by Ingy döt Net | 09 Dec 2023 | 3 min read What&#39;s the best thing about Rudolph&#39;s nose? Is it that lights the way for..."><meta property="og:description" content="Coding with Style by Ingy döt Net | 09 Dec 2023 | 3 min read What&#39;s the best thing about Rudolph&#39;s nose? Is it that lights the way for..."><meta name="description" content="Coding with Style by Ingy döt Net | 09 Dec 2023 | 3 min read What&#39;s the best thing about Rudolph&#39;s nose? Is it that lights the way for..."><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/"><img src="/images/yamlscript-logo.svg"></a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/doc">Docs</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/about">About</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>Coding with Style</h1><div class="post__details">by <a href="/about/#ingydotnet">Ingy döt Net</a> <span>| </span><time datetime="2023-12-09">09 Dec 2023 </time><span>| </span><span>3 min read</span></div></header><main class="post__content"><p>What's the best thing about Rudolph's nose? Is it that lights the way for Santa's sleigh? I'm calling BS on that. I'd say it's the main thing that gives the whole <strong>Sanata Story some Serious Style!</strong></p><p>Good programmers do more than just get their solutions right. They do the whole thing with style. That makes the program easier to read, understand and maintain. It also gives the code a certain je ne sais quoi.</p><h3>Welcome to Day 9 of the YAMLScript Advent Calendar</h3><p>We know that YAMLScript compiles to Clojure. And we know that YAML doesn't really look anything like a Lisp. But it turns out that YAMLScript can use as much or as little Lisp style as you want it to. It's all about your personal style.</p><p>Here's a YS program that sings my favorite drinking song:</p><pre class="language-yaml"><code class="language-yaml"><span class="token comment">#!/usr/bin/env ys-0</span><br><span class="token comment"># 99-bottles.ys</span><br><br><span class="token comment"># Print the verses to "99 Bottles of Beer"</span><br><span class="token comment">#</span><br><span class="token comment"># usage:</span><br><span class="token comment">#   ys 99-bottles.ys [&lt;count>]</span><br><br><span class="token key atrule">defn main(number=99)</span><span class="token punctuation">:</span><br>  <span class="token key atrule">each n (number .. 1)</span><span class="token punctuation">:</span><br>    <span class="token key atrule">say</span><span class="token punctuation">:</span> paragraph(n)<br><br><span class="token key atrule">defn paragraph(num)</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string"><br>  $bottles(num) of beer on the wall,<br>  $bottles(num) of beer.<br>  Take one down, pass it around.<br>  $bottles(num - 1) of beer on the wall.</span><br><br><span class="token key atrule">defn bottles(n)</span><span class="token punctuation">:</span><br>  <span class="token key atrule">cond</span><span class="token punctuation">:</span><br>    <span class="token key atrule">n == 0</span> <span class="token punctuation">:</span> <span class="token string">'No more bottles'</span><br>    <span class="token key atrule">n == 1</span> <span class="token punctuation">:</span> <span class="token string">'1 bottle'</span><br>    <span class="token key atrule">else</span>   <span class="token punctuation">:</span> <span class="token string">"$n bottles"</span></code></pre><p>Let's give it a try:</p><pre class="language-bash"><code class="language-bash">$ ys <span class="token number">99</span>-bottles.ys <span class="token number">3</span><br><span class="token number">3</span> bottles of beer on the wall,<br><span class="token number">3</span> bottles of beer.<br>Take one down, pass it around.<br><span class="token number">2</span> bottles of beer on the wall.<br><br><span class="token number">2</span> bottles of beer on the wall,<br><span class="token number">2</span> bottles of beer.<br>Take one down, pass it around.<br><span class="token number">1</span> bottle of beer on the wall.<br><br><span class="token number">1</span> bottle of beer on the wall,<br><span class="token number">1</span> bottle of beer.<br>Take one down, pass it around.<br>No <span class="token function">more</span> bottles of beer on the wall.</code></pre><p>I feel tipsy.</p><p>Let's compile this program to Clojure and see what it looks like:</p><pre class="language-clojure"><code class="language-clojure">$ ys -c <span class="token number">99</span>-bottles.ys<br><span class="token punctuation">(</span><span class="token keyword">declare</span> paragraph bottles<span class="token punctuation">)</span><br><span class="token punctuation">(</span><span class="token keyword">defn</span> main<br>  <span class="token punctuation">(</span><span class="token punctuation">[</span>number<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token function">each</span> <span class="token punctuation">[</span>n <span class="token punctuation">(</span><span class="token function">rng</span> number <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token function">say</span> <span class="token punctuation">(</span><span class="token function">paragraph</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token function">main</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">(</span><span class="token keyword">defn</span> paragraph <span class="token punctuation">[</span>num<span class="token punctuation">]</span><br>  <span class="token punctuation">(</span><span class="token keyword">str</span> <span class="token punctuation">(</span><span class="token function">bottles</span> num<span class="token punctuation">)</span><br>       <span class="token string">" of beer on the wall,\n"</span> <span class="token punctuation">(</span><span class="token function">bottles</span> num<span class="token punctuation">)</span><br>       <span class="token string">" of beer.\nTake one down, pass it around.\n"</span> <span class="token punctuation">(</span><span class="token function">bottles</span> <span class="token punctuation">(</span><span class="token keyword">-</span> num <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>       <span class="token string">" of beer on the wall."</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">(</span><span class="token keyword">defn</span> bottles <span class="token punctuation">[</span>n<span class="token punctuation">]</span><br>  <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token keyword">=</span> n <span class="token number">0</span><span class="token punctuation">)</span> <span class="token string">"No more bottles"</span><br>        <span class="token punctuation">(</span><span class="token keyword">=</span> n <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">"1 bottle"</span><br>        <span class="token symbol">:else</span> <span class="token punctuation">(</span><span class="token keyword">str</span> n <span class="token string">" bottles"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">(</span><span class="token keyword">apply</span> main ARGS<span class="token punctuation">)</span></code></pre><p>It turns out that the compiled Clojure code is actually valid YAMLScript syntax as well. Well, almost.</p><p>The file is valid YAML. It represents a single big string. Normally YAML files represent a single big mapping or sequence, but they can also define a top level scalar (string).</p><p>If I run this program though, it doesn't print anything. The reason is simple. We didn't give it the power to. We didn't add the <code>!yamlscript/v0</code> tag to the beginning of the file.</p><p>If we do that it works fine.</p><p>So apparently we can write YAMLScript in a purely Lisp style. The truth is you can write YAMLScript is a completely YAML style (no parens), a completely Lisp style (all parens), or somewhere in between.</p><p>Good looking YS programs start with YAML style and then switch to the Lisp style for certain nicer idioms. Note that you can't switch back to YAML style once you've switched to Lisp style.</p><p>Let's iterate on the above code and make it YAML just at the top level:</p><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">defn main</span><span class="token punctuation">:</span><br>  (<span class="token punctuation">[</span>number<span class="token punctuation">]</span> (each <span class="token punctuation">[</span>n (rng number 1)<span class="token punctuation">]</span> (say (paragraph n))))<br>  (<span class="token punctuation">[</span><span class="token punctuation">]</span> (main 99))<br>defn paragraph <span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">:</span><br>  (str (bottles num)<br>       " of beer on the wall<span class="token punctuation">,</span>\n" (bottles num)<br>       " of beer.\nTake one down<span class="token punctuation">,</span> pass it around.\n" (bottles (<span class="token punctuation">-</span> num 1))<br>       " of beer on the wall." "\n")<br>defn bottles <span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">:</span><br>  (cond (= n 0) "No more bottles"<br>        (= n 1) "1 bottle"<br>        <span class="token punctuation">:</span>else (str n " bottles"))<br><span class="token key atrule">apply</span><span class="token punctuation">:</span> main ARGS</code></pre><p>That already looks a lot better.</p><p>We get a big win turning the <code>paragraph</code> into a YAML literal scalar (heredoc) with string interpolation.</p><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">defn paragraph(num)</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string"><br>  $bottles(num) of beer on the wall,<br>  $bottles(num) of beer.<br>  Take one down, pass it around.<br>  $bottles(num - 1) of beer on the wall.</span></code></pre><p>That's so much easier to read and understand.</p><p>I hope you are inspired to write some beautiful YAMLScript code.</p><p><strong>You've got style, baby!</strong></p><p>Come back tomorrow for day 10 of the YAMLScript Advent Calendar.</p></main><aside class="post__aside"><div class="post__tags"><a href="/tags/blog/">#blog</a> <a href="/tags/advent-2023/">#advent-2023</a></div><nav class="post__pagination"><a href="/posts/advent-2023/dec-08/"><span>←</span> <span>Going to the Library</span> </a><a href="/posts/advent-2023/dec-10/"><span>States and Ladders</span> <span>→</span></a></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a href="https://github.com/yaml/yamlscript" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul><p class="footer__attribution">Powered by <a href="https://www.11ty.dev" target="_blank" rel="noopener">Eleventy</a>. Theme: <a href="https://github.com/yinkakun/eleventy-duo" target="_blank" rel="noopener noreferrer">Eleventy Duo</a>.</p></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>