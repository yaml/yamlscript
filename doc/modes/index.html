<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-44C9DS3Q80"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-44C9DS3Q80');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="canonical" href=https://yamlscript.org/doc/modes/>

    <link href="/assets/main.css" rel="stylesheet" />

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet">

    <title>
      YAMLScript Syntax Modes
      
         | YAMLScript
      
    </title>

    <link rel="icon" type= “image/x-icon” href="/images/favicon.ico">

    <meta property="og:title" content="YAMLScript Syntax Modes">
    <meta property="og:site_name" content="YAMLScript"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://yamlscript.org/doc/modes/"/>
    <meta name="twitter:card" content="summary_large_image">

    

    
    
      
    
    
      <meta name="description" content="YAMLScript Syntax Modes One of the most important things to understand when learning YAMLScript is the concept of &amp;quot;modes&amp;quot;. It...">
      <meta property="og:description" content="YAMLScript Syntax Modes One of the most important things to understand when learning YAMLScript is the concept of &amp;quot;modes&amp;quot;. It...">
      <meta name="description" content="YAMLScript Syntax Modes One of the most important things to understand when learning YAMLScript is the concept of &amp;quot;modes&amp;quot;. It..."/>
    

    
      
    
    

    
      <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
      <script>mermaid.initialize({startOnLoad:true});</script>
    
  </head>
  <body>
    <div class="layout-wrapper">

      <header class="header">
        <div class="header__content">
          <h1 class="site-title">
            <a href=/>
              <img src="/images/yamlscript.svg">
              <!-- YAMLScript -->
            </a>
          </h1>

          
            <nav class="nav">
              <ul class="nav__list">
                
                  
                  

                  

                  

                  <li class="nav-item">
                    <a href="/doc"  >Docs</a>
                  </li>
                
                  
                  

                  

                  

                  <li class="nav-item">
                    <a href="/blog"  >Blog</a>
                  </li>
                
                  
                  

                  

                  

                  <li class="nav-item">
                    <a href="/about"  >About</a>
                  </li>
                
              </ul>
            </nav>

          

        </div>
      </header>

      <main class="main">
        
<article class="post">
  <header class="post__header">
    <h1>YAMLScript Syntax Modes</h1>
  </header>

  <main class="post__content">
    <p>One of the most important things to understand when learning YAMLScript is the
concept of &quot;modes&quot;.</p>
<p>It basically comes down to whether an unquoted scalar like <code>count</code> should be
considered as a data string or a code symbol (variable, function name etc).
Since YAMLScript's main focus is about embedding code into YAML data files,
it's very important to know what mode you are in at any given point.</p>
<p>YAMLScript has 3 modes:</p>
<ul>
<li>Bare mode</li>
<li>Data mode</li>
<li>Code mode</li>
</ul>
<p>The important one to learn about are data and code modes.
To use YAMLScript effectively you'll need to be comfortable with switching back
and forth between data the two.</p>
<p>Bare mode is the default when you haven't added a <code>!yamlscript</code> tag to the
start of a YAML document.
It means that everything in the file is data; code can never be used.
This is how we can make sure that existing YAML files are valid YAMLScript.</p>
<p>To enable a YAML file to use YAMLScript code, you need to add one of these tags
to the top:</p>
<ul>
<li><code>!yamlscript/v0/code</code> - Start in code mode.</li>
<li><code>!yamlscript/v0/data</code> - Start in data mode.</li>
<li><code>!yamlscript/v0</code> - Short for <code>!yamlscript/v0/code</code></li>
<li><code>!yamlscript/v0/</code> - Short for <code>!yamlscript/v0/data</code></li>
</ul>
<p>Consider the following examples.</p>
<p>Bare mode:</p>
<pre class="language-text"><code class="language-text">$ ys --load <(echo '<br>foo:<br>  count: [red, green, blue]')<br>{"foo":{"count":["red","green","blue"]}}</code></pre>
<p>Data mode:</p>
<pre class="language-text"><code class="language-text">$ ys --load <(echo '<br>!yamlscript/v0/<br>foo:<br>  count: [red, green, blue]')<br>{"foo":{"count":["red","green","blue"]}}</code></pre>
<p>Code mode:</p>
<pre class="language-text"><code class="language-text">$ ys --load <(echo '<br>!yamlscript/v0<br>foo:<br>  count: [red, green, blue]')<br>Error: Sequences (block and flow) not allowed in code mode</code></pre>
<p>Oops.
Looks like we need to switching to data mode in there.</p>
<h2>Switching Modes</h2>
<p>If we want to add a function to a data file we should start in data mode.
Then we should switch to code mode for things that are code.</p>
<p>Here we want to call the <code>count</code> function with a sequence and get back 3, the
number of elements in the sequence.</p>
<p>The special tag <code>!</code> can be used to switch from data to code and vice versa.</p>
<pre class="language-text"><code class="language-text">$ ys --load <(echo '<br>!yamlscript/v0/<br>foo: !<br>  count: [red, green, blue]')<br>Error: Sequences (block and flow) not allowed in code mode</code></pre>
<p>Here we started in data mode but then switched the mode to code with <code>!</code>.
We got the same error.
YAMLScript only allows block mappings for code.
We need to put <code>[red, green, blue]</code> into data mode:</p>
<pre><code>$ ys --load &lt;(echo '
!yamlscript/v0/
foo: !
  count: ! [red, green, blue]')
{&quot;foo&quot;:3}
</code></pre>
<p>It worked!</p>
<p>Using <code>!</code> is so common that YAMLScript has a cleaner way to do it when used on
a mapping pair value.
If you use <code>::</code> instead of <code>:</code> it does the same thing.</p>
<p>Let's try it out:</p>
<pre><code>$ ys --load &lt;(echo '
!yamlscript/v0/
foo::
  count:: [red, green, blue]')
{&quot;foo&quot;:3}
</code></pre>
<p>Sweet!</p>
<p>However, when <em>switching in a sequence</em> you'll need to use <code>!</code>:</p>
<pre><code>$ ys --load &lt;(echo '
!yamlscript/v0/
- !
  count:: [red, green, blue]')
[3]
</code></pre>
<p>NOTE: <code>::</code> isn't special YAML syntax.
YAMLScript cannot change YAML 1.2 syntax in any way.
In the examples above <code>count:</code> is simply a plain scalar ending with <code>:</code>.</p>
<p>We can see that in bare mode:</p>
<pre><code>$ ys --load &lt;(echo '
count:: [red, green, blue]')
{&quot;count:&quot;:[&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;]}
</code></pre>

  </main>

  <aside class="post__aside">
    <nav class="post__pagination">
    </nav>
  </aside>

</article>

      </main>

      <footer class="footer">
        <div class="footer__content">

          <ul class="hero__social-links">
            
              
            

            

              
                

                
                  
                

                <li>
                  <a href="https://github.com/yaml/yamlscript" target="_blank" rel="noopener noreferrer" >GitHub</a>
                </li>
              
                

                
                  
                

                <li>
                  <a href="/feed.xml" target="_blank" rel="noopener noreferrer" >RSS</a>
                </li>
              
            
          </ul>

          
            <p class="footer__attribution">
      Powered by
      <a href="https://www.11ty.dev" target="_blank" rel="noopener">Eleventy</a>.
      Theme:
      <a href="https://github.com/yinkakun/eleventy-duo" target="_blank" rel="noopener noreferrer">Eleventy Duo</a>.
            </p>
          

        </div>
      </div>

    </footer>

    <script src="/assets/main.js"></script>
  </body>
</html>
