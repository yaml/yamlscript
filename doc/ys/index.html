<!doctype html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-44C9DS3Q80"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-44C9DS3Q80');</script><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://yamlscript.org/doc/ys/"><link href="/assets/main.ba27954d2f63d1b86fb9.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>ys - The YAMLScript Command Line Tool | YAMLScript</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="ys - The YAMLScript Command Line Tool"><meta property="og:site_name" content="YAMLScript"><meta property="og:type" content="website"><meta property="og:url" content="https://yamlscript.org/doc/ys/"><meta name="twitter:card" content="summary_large_image"><meta name="description" content="ys - The YAMLScript Command Line Tool The YAMLScript ys command line tool is the primary way to run, load and compile YAMLScript programs...."><meta property="og:description" content="ys - The YAMLScript Command Line Tool The YAMLScript ys command line tool is the primary way to run, load and compile YAMLScript programs...."><meta name="description" content="ys - The YAMLScript Command Line Tool The YAMLScript ys command line tool is the primary way to run, load and compile YAMLScript programs...."><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/"><img src="/images/yamlscript.svg"></a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/doc">Docs</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/about">About</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>ys - The YAMLScript Command Line Tool</h1></header><main class="post__content"><p>The YAMLScript <code>ys</code> command line tool is the primary way to run, load and compile YAMLScript programs.</p><p>Loading is essentially the same as running, but the result is output is printed as JSON.</p><pre class="language-text"><code class="language-text">$ ys --help<br><br>ys - The YAMLScript (YS) Command Line Tool - v0.1.62<br><br>Usage: ys [<option...>] [<file>]<br><br>Options:<br><br>      --run                Run a YAMLScript program file (default)<br>  -l, --load               Output (compact) JSON of YAMLScript evaluation<br>  -e, --eval YSEXPR        Evaluate a YAMLScript expression<br>                           multiple -e values joined by newline<br><br>  -c, --compile            Compile YAMLScript to Clojure<br>  -b, --binary             Compile to a native binary executable<br><br>  -p, --print              Print the result of --run in code mode<br>  -o, --output FILE        Output file for --load, --compile or --binary<br><br>  -T, --to FORMAT          Output format for --load:<br>                             json, yaml, edn<br>  -J, --json               Output (pretty) JSON for --load<br>  -Y, --yaml               Output YAML for --load<br>  -E, --edn                Output EDN for --load<br>  -O, --ordered            Mappings preserve key order<br><br>  -m, --mode MODE          Add a mode tag: code, data, or bare (for -e)<br>  -C, --clojure            Treat input as Clojure code<br><br>  -d                       Debug all compilation stages<br>  -D, --debug-stage STAGE  Debug a specific compilation stage:<br>                             parse, compose, resolve, build,<br>                             transform, construct, print<br>                           can be used multiple times<br>  -S, --stack-trace        Print full stack trace for errors<br>  -x, --xtrace             Print each expression before evaluation<br><br>      --install            Install the libyamlscript shared library<br>      --upgrade            Upgrade both ys and libyamlscript<br><br>      --version            Print version and exit<br>  -h, --help               Print this help and exit</file></option...></code></pre><hr><p>Let's start with a YAML file (<code>some.yaml</code>) that wants to use data from another YAML file and also do some simple calculations:</p><pre class="language-yaml"><code class="language-yaml"><span class="token tag">!yamlscript/v0/</span><br><br><span class="token key atrule">=></span><span class="token punctuation">:</span><br>  <span class="token key atrule">name =</span><span class="token punctuation">:</span> <span class="token string">"World"</span><br>  <span class="token key atrule">data =</span><span class="token punctuation">:</span> load("data1.yaml")<br>  <span class="token key atrule">fruit =</span><span class="token punctuation">:</span> data.food.fruit<br><br><span class="token key atrule">num</span><span class="token punctuation">:</span> <span class="token number">123</span><br>greet<span class="token punctuation">:</span><span class="token punctuation">:</span> <span class="token string">"$(data.hello.rand-nth()), $name!"</span><br>eat<span class="token punctuation">:</span><span class="token punctuation">:</span> fruit.shuffle().first()<br>drink<span class="token punctuation">:</span><span class="token punctuation">:</span> (<span class="token punctuation">[</span><span class="token string">"Bar"</span><span class="token punctuation">]</span> * 3).join('<span class="token punctuation">,</span> ' _).str('<span class="token tag">!</span><span class="token tag">!!')</span></code></pre><p>Here's the other YAML file (<code>data1.yaml</code>):</p><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">food</span><span class="token punctuation">:</span><br>  <span class="token key atrule">fruit</span><span class="token punctuation">:</span><br>  <span class="token punctuation">-</span> apple<br>  <span class="token punctuation">-</span> banana<br>  <span class="token punctuation">-</span> cherry<br>  <span class="token punctuation">-</span> date<br><br><span class="token key atrule">hello</span><span class="token punctuation">:</span><br><span class="token punctuation">-</span> Aloha<br><span class="token punctuation">-</span> Bonjour<br><span class="token punctuation">-</span> Ciao<br><span class="token punctuation">-</span> Dzień dobry</code></pre><p>We can &quot;load&quot; the YAML/YAMLScript file with the <code>ys</code> command and it will print the result as JSON:</p><pre class="language-bash"><code class="language-bash">$ ys <span class="token parameter variable">-l</span> some.yaml <br><span class="token punctuation">{</span><span class="token string">"num"</span>:123,<span class="token string">"greet"</span><span class="token builtin class-name">:</span><span class="token string">"Bonjour, World!"</span>,<span class="token string">"eat"</span><span class="token builtin class-name">:</span><span class="token string">"apple"</span>,<span class="token string">"drink"</span><span class="token builtin class-name">:</span><span class="token string">"Bar, Bar, Bar!!!"</span><span class="token punctuation">}</span></code></pre><p>We can also format the output as YAML:</p><pre class="language-bash"><code class="language-bash"> ys <span class="token parameter variable">-lY</span> some.yaml <br>num: <span class="token number">123</span><br>greet: Ciao, World<span class="token operator">!</span><br>eat: cherry<br>drink: Bar, Bar, Bar<span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span></code></pre><hr><p>Here's a tiny YAMLScript program called <code>program.ys</code>:</p><pre class="language-yaml"><code class="language-yaml"><span class="token tag">!yamlscript/v0</span><br><br><span class="token key atrule">defn main(name='world' n=3)</span><span class="token punctuation">:</span><br>  <span class="token key atrule">greet</span><span class="token punctuation">:</span> name n<br><br>defn greet(name<span class="token punctuation">,</span> <span class="token key atrule">times=1)</span><span class="token punctuation">:</span><br>  each <span class="token punctuation">[</span>i (1 .. times)<span class="token punctuation">]</span><span class="token punctuation">:</span><br>    <span class="token key atrule">say</span><span class="token punctuation">:</span> <span class="token string">"$i) Hello, $name!"</span></code></pre><p>We can run this program with the <code>ys</code> command:</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">time</span> ys program.ys<br><span class="token number">1</span><span class="token punctuation">)</span> Hello, world<span class="token operator">!</span><br><span class="token number">2</span><span class="token punctuation">)</span> Hello, world<span class="token operator">!</span><br><span class="token number">3</span><span class="token punctuation">)</span> Hello, world<span class="token operator">!</span><br><br>real	0m0.021s<br>user	0m0.014s<br>sys	0m0.007s<br></code></pre><p>Pretty fast, right?</p><p>We can pass in arguments:</p><pre class="language-bash"><code class="language-bash">$ ys program.ys Bob <span class="token number">2</span><br> ys program.ys Bob <span class="token number">2</span><br><span class="token number">1</span><span class="token punctuation">)</span> Hello, Bob<span class="token operator">!</span><br><span class="token number">2</span><span class="token punctuation">)</span> Hello, Bob<span class="token operator">!</span></code></pre><hr><p>To see what Clojure code is being generated under the hood:</p><pre class="language-clojure"><code class="language-clojure">$ ys -c program.ys<br><span class="token punctuation">(</span><span class="token keyword">declare</span> greet<span class="token punctuation">)</span><br><span class="token punctuation">(</span><span class="token keyword">defn</span> main<br>  <span class="token punctuation">(</span><span class="token punctuation">[</span>name n<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token function">greet</span> name n<span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">(</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token function">main</span> name <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token function">main</span> <span class="token string">"world"</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">(</span><span class="token keyword">defn</span> greet<br>  <span class="token punctuation">(</span><span class="token punctuation">[</span>name times<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token function">each</span> <span class="token punctuation">[</span>i <span class="token punctuation">(</span><span class="token function">rng</span> <span class="token number">1</span> times<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token function">say</span> <span class="token punctuation">(</span><span class="token keyword">str</span> i <span class="token string">") Hello, "</span> name <span class="token string">"!"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>  <span class="token punctuation">(</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token function">greet</span> name <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">(</span><span class="token keyword">apply</span> main ARGS<span class="token punctuation">)</span></code></pre><hr><p>You can compile the program to a native binary executable:</p><pre class="language-text"><code class="language-text">$ time ys -b program.ys <br>* Compiling YAMLScript 'program.ys' to 'program' executable<br>* Setting up build env in '/tmp/tmp.xU8K3OPymt'<br>* This may take a few minutes...<br>[1/8] Initializing		(2.8s @ 0.14GB)<br>[2/8] Performing analysis		(9.1s @ 0.33GB)<br>[3/8] Building universe		(1.2s @ 0.39GB)<br>[4/8] Parsing methods		(1.4s @ 0.41GB)<br>[5/8] Inlining methods		(0.9s @ 0.49GB)<br>[6/8] Compiling methods		(10.6s @ 0.50GB)<br>[7/8] Layouting methods		(1.0s @ 0.50GB)<br>[8/8] Creating image		(1.5s @ 0.44GB)<br>* Compiled YAMLScript 'program.ys' to 'program' executable<br><br>real	0m36.340s<br>user	4m34.165s<br>sys	0m3.915s<br><br>$ time ./program Bob 2<br>1) Hello, Bob!<br>2) Hello, Bob!<br><br>real	0m0.007s<br>user	0m0.003s<br>sys	0m0.004s</code></pre><p>As you can see, the native binary is faster than the interpreted version, but the compilation takes quite a long time.</p><hr><p>When debugging, you can see the output of each compilation stage by adding the <code>-d</code> option:</p><pre class="language-text"><code class="language-text">$ ys -cd program.ys<br>*** parse output ***<br>({:+ "+MAP", :! "yamlscript/v0"}<br> {:+ "=VAL", := "defn main(name='world' n=3)"}<br> {:+ "+MAP"}<br> {:+ "=VAL", := "greet"}<br> {:+ "=VAL", := "name n"}<br> {:+ "-MAP"}<br> {:+ "=VAL", := "defn greet(name, times=1)"}<br> {:+ "+MAP"}<br> {:+ "=VAL", := "each [i (1 .. times)]"}<br> {:+ "+MAP"}<br> {:+ "=VAL", := "say"}<br> {:+ "=VAL", :$ "$i) Hello, $name!"}<br> {:+ "-MAP"}<br> {:+ "-MAP"}<br> {:+ "-MAP"}<br> {:+ "-DOC"})<br><br>*** compose output ***<br>{:! "yamlscript/v0",<br> :%<br> [{:= "defn main(name='world' n=3)"}<br>  {:% [{:= "greet"} {:= "name n"}]}<br>  {:= "defn greet(name, times=1)"}<br>  {:%<br>   [{:= "each [i (1 .. times)]"}<br>    {:% [{:= "say"} {:$ "$i) Hello, $name!"}]}]}]}<br><br>*** resolve output ***<br>{:pairs<br> [{:defn "defn main(name='world' n=3)"}<br>  {:pairs [{:exp "greet"} {:exp "name n"}]}<br>  {:defn "defn greet(name, times=1)"}<br>  {:pairs<br>   [{:exp "each [i (1 .. times)]"}<br>    {:pairs [{:exp "say"} {:vstr "$i) Hello, $name!"}]}]}]}<br><br>*** build output ***<br>{:pairs<br> [[{:Sym defn} {:Sym main} nil]<br>  [{:Lst<br>    [{:Vec [{:Sym name} {:Sym n}]}<br>     {:pairs [{:Sym greet} [{:Sym name} {:Sym n}]]}]}<br>   {:Lst<br>    [{:Vec [{:Sym name}]} {:Lst [{:Sym main} {:Sym name} {:Int 3}]}]}<br>   {:Lst [{:Vec []} {:Lst [{:Sym main} {:Str "world"} {:Int 3}]}]}]<br>  [{:Sym defn} {:Sym greet} nil]<br>  [{:Lst<br>    [{:Vec [{:Sym name} {:Sym times}]}<br>     {:pairs<br>      [[{:Sym each}<br>        {:Vec [{:Sym i} {:Lst [{:Sym rng} {:Int 1} {:Sym times}]}]}]<br>       {:pairs<br>        [{:Sym say}<br>         {:Lst<br>          [{:Sym str}<br>           {:Sym i}<br>           {:Str ") Hello, "}<br>           {:Sym name}<br>           {:Str "!"}]}]}]}]}<br>   {:Lst<br>    [{:Vec [{:Sym name}]}<br>     {:Lst [{:Sym greet} {:Sym name} {:Int 1}]}]}]]}<br><br>*** transform output ***<br>{:pairs<br> [[{:Sym defn} {:Sym main} nil]<br>  [{:Lst<br>    [{:Vec [{:Sym name} {:Sym n}]}<br>     {:pairs [{:Sym greet} [{:Sym name} {:Sym n}]]}]}<br>   {:Lst<br>    [{:Vec [{:Sym name}]} {:Lst [{:Sym main} {:Sym name} {:Int 3}]}]}<br>   {:Lst [{:Vec []} {:Lst [{:Sym main} {:Str "world"} {:Int 3}]}]}]<br>  [{:Sym defn} {:Sym greet} nil]<br>  [{:Lst<br>    [{:Vec [{:Sym name} {:Sym times}]}<br>     {:pairs<br>      [[{:Sym each}<br>        {:Vec [{:Sym i} {:Lst [{:Sym rng} {:Int 1} {:Sym times}]}]}]<br>       {:pairs<br>        [{:Sym say}<br>         {:Lst<br>          [{:Sym str}<br>           {:Sym i}<br>           {:Str ") Hello, "}<br>           {:Sym name}<br>           {:Str "!"}]}]}]}]}<br>   {:Lst<br>    [{:Vec [{:Sym name}]}<br>     {:Lst [{:Sym greet} {:Sym name} {:Int 1}]}]}]]}<br><br>*** construct output ***<br>{:Top<br> [{:Lst [{:Sym declare} {:Sym greet}]}<br>  {:Lst<br>   [{:Sym defn}<br>    {:Sym main}<br>    nil<br>    {:Lst<br>     [{:Vec [{:Sym name} {:Sym n}]}<br>      {:Lst [{:Sym greet} {:Sym name} {:Sym n}]}]}<br>    {:Lst<br>     [{:Vec [{:Sym name}]} {:Lst [{:Sym main} {:Sym name} {:Int 3}]}]}<br>    {:Lst [{:Vec []} {:Lst [{:Sym main} {:Str "world"} {:Int 3}]}]}]}<br>  {:Lst<br>   [{:Sym defn}<br>    {:Sym greet}<br>    nil<br>    {:Lst<br>     [{:Vec [{:Sym name} {:Sym times}]}<br>      {:Lst<br>       [{:Sym each}<br>        {:Vec [{:Sym i} {:Lst [{:Sym rng} {:Int 1} {:Sym times}]}]}<br>        {:Lst<br>         [{:Sym say}<br>          {:Lst<br>           [{:Sym str}<br>            {:Sym i}<br>            {:Str ") Hello, "}<br>            {:Sym name}<br>            {:Str "!"}]}]}]}]}<br>    {:Lst<br>     [{:Vec [{:Sym name}]}<br>      {:Lst [{:Sym greet} {:Sym name} {:Int 1}]}]}]}<br>  {:Lst [{:Sym +++} {:Lst [{:Sym apply} {:Sym main} {:Sym ARGS}]}]}]}<br><br>*** print output ***<br>"(declare greet)(defn main  ([name n] (greet name n)) ([name] (main name 3))...<br><br>(declare greet)<br>(defn main<br>  ([name n] (greet name n))<br>  ([name] (main name 3))<br>  ([] (main "world" 3)))<br>(defn greet<br>  ([name times] (each [i (rng 1 times)] (say (str i ") Hello, " name "!"))))<br>  ([name] (greet name 1)))<br>(+++ (apply main ARGS))</code></pre></main><aside class="post__aside"><nav class="post__pagination"></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a href="https://github.com/yaml/yamlscript" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul><p class="footer__attribution">Powered by <a href="https://www.11ty.dev" target="_blank" rel="noopener">Eleventy</a>. Theme: <a href="https://github.com/yinkakun/eleventy-duo" target="_blank" rel="noopener noreferrer">Eleventy Duo</a>.</p></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>