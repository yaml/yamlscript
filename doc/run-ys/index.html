<!doctype html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-44C9DS3Q80"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-44C9DS3Q80');</script><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="canonical" href="https://yamlscript.org/doc/run-ys/"><link href="/assets/main.769d3d1b7edc71568d89.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap" rel="stylesheet"><title>Self Installation Scripts | YAMLScript</title><link rel="icon" type="“image/x-icon”" href="/images/favicon.ico"><meta property="og:title" content="Self Installation Scripts"><meta property="og:site_name" content="YAMLScript"><meta property="og:type" content="website"><meta property="og:url" content="https://yamlscript.org/doc/run-ys/"><meta name="twitter:card" content="summary_large_image"><meta name="description" content="Self Installation Scripts Note: If you just ran a program with bash that printed a URL to this page, click the arrow below for more..."><meta property="og:description" content="Self Installation Scripts Note: If you just ran a program with bash that printed a URL to this page, click the arrow below for more..."><meta name="description" content="Self Installation Scripts Note: If you just ran a program with bash that printed a URL to this page, click the arrow below for more..."><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:true});</script></head><body><div class="layout-wrapper"><header class="header"><div class="header__content"><h1 class="site-title"><a href="/"><img src="/images/yamlscript-logo.svg"></a></h1><nav class="nav"><ul class="nav__list"><li class="nav-item"><a href="/doc">Docs</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="/about">About</a></li></ul></nav></div></header><main class="main"><article class="post"><header class="post__header"><h1>Self Installation Scripts</h1></header><main class="post__content"><blockquote><p><strong>Note</strong>: If you just ran a program with <code>bash</code> that printed a URL to this page, click the arrow below for more information on &quot;What just happened?&quot;.</p><details><summary><strong>What just happened?</strong></summary><p>If you are reading this you probably just ran a YAMLScript program with <code>bash</code>. The first time you do that, the program installed the <code>ys</code> interpreter under the <code>/tmp/</code> directory for you and then ran the program with it. Subsequent runs of the program will use that installed <code>ys</code> interpreter.</p><p>You may continue to run the program this way, but there will be a slight delay at the start each time while the <code>run-ys</code> auto-installer script is downloaded.</p><p>It is very easy to install the <code>ys</code> interpreter permanently on your system so that you can run the program with <code>ys</code> instead of <code>bash</code>.</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> <span class="token parameter variable">-s</span> https://yamlscript.org/install-ys <span class="token operator">|</span> <span class="token function">bash</span></code></pre><p>See the <a href="/doc/install">YAMLScript Installation</a> page for more information.</p></details></blockquote><hr><p>YAMLScript has a way to publish programs that people can run immediately without having installed the <code>ys</code> interpreter first.</p><blockquote><p><strong>Warning</strong>: See the <a href="#use-cases-and-security-considerations">Security Considerations</a> below before using this technique.</p></blockquote><p>Just begin your YAMLScript program with these lines:</p><pre class="language-yaml"><code class="language-yaml"><span class="token comment">#!/usr/bin/env ys-0</span><br><span class="token key atrule">source &lt;(curl '-s' 'https://yamlscript.org/run-ys') "$@"</span> <span class="token punctuation">:</span></code></pre><p>Then anyone can run your program using Bash with a command like this: <code>bash script.ys arg1 arg2 ...</code>.</p><p>The first time they do so, the <code>ys</code> interpreter will be downloaded and installed under the <code>/tmp/</code> directory.</p><p>The <code>ys</code> interpreter will be downloaded only once, and it will be used for all subsequent runs of the script.</p><blockquote><p>Note: The <code>curl</code> command will still download and evaluate the <code>run-ys</code> Bash script on subsequent runs so the user will need to have internet access.</p></blockquote><p>The program can also be run with the <code>ys</code> interpreter if the user installs it. In that case the Bash installer line will be ignored.</p><p>Since the program has a shebang line, it can also be run as a <code>PATH</code> command if the file is marked as executable.</p><h2>Example</h2><p>Here's a small YAMLScript program that program that prints the ROT13 encoding of its arguments:</p><pre class="language-yaml"><code class="language-yaml"><span class="token comment">#!/usr/bin/env ys-0</span><br><br><span class="token key atrule">source &lt;(curl '-s' 'https://yamlscript.org/run-ys') "$@"</span> <span class="token punctuation">:</span><br><br><span class="token key atrule">alphabet =</span><span class="token punctuation">:</span> set((\\A .. \\Z) + (\\a .. \\z))<br><span class="token key atrule">rot13 =</span><span class="token punctuation">:</span> cycle(alphabet).drop(13 * 2).zipmap(alphabet)<br><br><span class="token key atrule">defn main(*input)</span><span class="token punctuation">:</span><br>  <span class="token key atrule">say</span><span class="token punctuation">:</span> str/escape(input.join(' ') rot13)</code></pre><p>If we run it with <code>ys</code>:</p><pre class="language-bash"><code class="language-bash">$ ys rot13.ys I Love YS<br>V Ybir LF</code></pre><p>If we run it with <code>bash</code>:</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">bash</span> rot13.ys I Love YS<br>Installing YAMLScript CLI <span class="token string">'/tmp/yamlscript-run-ys/bin/ys-0.1.79'</span> now<span class="token punctuation">..</span>.<br>Ctl-C to abort<br>See https://yamlscript.org/doc/run-ys <span class="token keyword">for</span> <span class="token function">more</span> information.<br><br>Installed /tmp/yamlscript-run-ys/bin/ys - version <span class="token number">0.1</span>.79<br>--------------------------------------------------------------------------------<br>V Ybir LF</code></pre><p>and again:</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">bash</span> rot13.ys I Love YS<br>V Ybir LF</code></pre><h2>How It Works</h2><p>The program is both valid YAMLScript and valid Bash.</p><p>YAMLScript programs are required to start with a YAML tag like this:</p><pre class="language-yaml"><code class="language-yaml"><span class="token tag">!yamlscript/v0</span></code></pre><p>But if they start with a shebang line like this:</p><pre class="language-yaml"><code class="language-yaml"><span class="token comment">#!/usr/bin/env ys-0</span></code></pre><p>then the <code>!yamlscript/v0</code> tag is optional.</p><p>When you run the program with <code>bash</code>, the shebang line is merely a comment and ignored by Bash.</p><p>The <code>source</code> line is a Bash command that reads and evaluates the contents of the <code>&lt;(...)</code> process substitution file. The <code>curl</code> command inside downloads the <code>run-ys</code> script and installs the <code>ys</code> interpreter under the <code>/tmp/</code> directory if it is not already installed.</p><p>It then <code>exec</code>s the installed <code>ys</code> interpreter with your original program and any arguments you provided.</p><p>The <code>source</code> line is also a valid YAMLScript command. It calls the YAMLScript <code>source</code> macro which ignores all of its arguments (much like the <code>comment</code> macro does).</p><blockquote><p>Note: The <code>source</code> macro was added in YAMLScript version 0.1.79. This technique will not work with earlier versions of YAMLScript.</p></blockquote><h2>Use Cases and Security Considerations</h2><p>This technique is may be useful in situations where you want to share a YAMLScript program with people who are not yet familiar with YAMLScript.</p><p>Since the program is run with Bash which gets more Bash code from the internet, it is subject to the many security risks of running arbitrary code from the internet.</p><p>Caveat yamlscriptor!</p><blockquote><p>** Note**: A more secure way to distribute a YAMLScript program is to <a href="/doc/binary">compile it to a binary executable</a> and distribute the binary instead.</p></blockquote><p>There is at least one use case where this Bash technique is safe and useful:</p><p>You can easily run a YAMLScript program that you are developing with a particular version of the <code>ys</code> interpreter without having to install it first. Just use the <code>YS_VERSION</code> environment variable to specify the version you want:</p><pre class="language-bash"><code class="language-bash">$ <span class="token assign-left variable">YS_VERSION</span><span class="token operator">=</span><span class="token number">0.1</span>.79 <span class="token function">bash</span> my-program.ys arg1 arg2 <span class="token punctuation">..</span>.</code></pre><p>This might be useful for testing a reported bug with an older version of the interpreter, for example.</p><p>There may be other development and testing use cases for this technique as well. If you find one, please let us know!</p></main><aside class="post__aside"><nav class="post__pagination"></nav></aside></article></main><footer class="footer"><div class="footer__content"><ul class="hero__social-links"><li><a href="https://github.com/yaml/yamlscript" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="/feed.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul><p class="footer__attribution">Powered by <a href="https://www.11ty.dev" target="_blank" rel="noopener">Eleventy</a>. Theme: <a href="https://github.com/yinkakun/eleventy-duo" target="_blank" rel="noopener noreferrer">Eleventy Duo</a>.</p></div></footer></div><script src="/assets/main.31d6cfe0d16ae931b73c.js"></script></body></html>